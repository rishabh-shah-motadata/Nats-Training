# ===========================================
# Leafnode Server Configuration
# ===========================================

server_name: leaf-1
listen: 0.0.0.0:4222

# ===========================================
# Accounts
# ===========================================
accounts {
    # System account (must match cluster)
    SYS: {
        users: [{user: sys, password: sys}]
    }
    
    # Application account
    APP: {
        users: [{user: app, password: app}]
        
        # Import subjects from the cluster
        imports: [
            # Import JetStream API subjects from cluster
            {stream: {account: APP, subject: "$JS.API.>"}}
            
            # Import JetStream acknowledgments
            {stream: {account: APP, subject: "$JS.ACK.>"}}
            
            # Import application subjects
            {stream: {account: APP, subject: "orders.>"}}
            
            # Import JetStream events
            {stream: {account: APP, subject: "$JS.EVENT.>"}}
            
            # Import reply subjects
            {stream: {account: APP, subject: "_INBOX.>"}}
        ]
        
        # Export subjects back to cluster
        exports: [
            # Export application subjects to cluster
            {stream: "orders.>"}
            
            # Export reply subjects
            {stream: "_INBOX.>", accounts: ["*"]}
        ]
    }
}

system_account: SYS

# ===========================================
# Leafnode Configuration
# ===========================================
leafnodes {
    # Connect to cluster as a leafnode
    remotes: [
        {
            # Cluster URLs
            urls: [
                nats://nats-1:7422,
                nats://nats-2:7422,
                nats://nats-3:7422
            ]
            
            # Use APP account
            account: APP
            
            # Credentials to connect to cluster
            credentials {
                user: app
                password: app
            }
        }
    ]
}

# ===========================================
# Monitoring
# ===========================================
http_port: 8222

# ===========================================
# Logging
# ===========================================
debug: false
trace: false
logtime: true